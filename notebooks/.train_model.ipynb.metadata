{"timestamp": 1646532480.856668, "stored_source_code": "Train a model\nimport pickle\n\nimport pandas as pd\nfrom sklearn.model_selection import train_test_split\nfrom sklearn.metrics import classification_report\nfrom sklearn.ensemble import RandomForestClassifier\nfrom sklearn_evaluation import plot\nupstream = ['build_features']\nproduct = None\ndf = pd.read_parquet(str(upstream['build_features']['data']))\nX = df.drop('target', axis='columns')\ny = df.target\nX_train, X_test, y_train, y_test = train_test_split(X,\n                                                    y,\n                                                    test_size=0.33,\n                                                    random_state=42)\nclf = RandomForestClassifier()\nclf.fit(X_train, y_train)\ny_pred = clf.predict(X_test)\nprint(classification_report(y_test, y_pred))\nplot.confusion_matrix(y_test, y_pred)\nwith open(product['model'], 'wb') as f:\n    pickle.dump(clf, f)", "params": {}}